import{_ as s}from"./plugin-vue_export-helper-c27b6911.js";import{r as d,o as a,c as l,b as e,d as n,e as t,a as r}from"./app-865676a6.js";const c={},o=e("h1",{id:"springboot-拦截器-自定义异常-自定义注解-全局异常处理",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#springboot-拦截器-自定义异常-自定义注解-全局异常处理","aria-hidden":"true"},"#"),n(" SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理")],-1),f={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},_={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},h={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},b={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},u={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},m={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},p={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},g={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},v={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},x={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},z={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},q={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},M={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},w={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},U={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},N={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},k={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},T={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},A={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},I={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},R={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},S=e("hr",null,null,-1),y={id:"前言",tabindex:"-1"},C=e("a",{class:"header-anchor",href:"#前言","aria-hidden":"true"},"#",-1),L={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},E=e("p",null,"提到权限管理这块肯定很多人第一想到的就是Springboot Security或者是Shiro安全框架，但本文介绍的并不是这两种，不是因为他们不好用，实在是自己太懒了，我觉得一个拦截器加上其他的一些处理就能满足项目的需求，我又何必去多用一个框架呢，这篇文章也不是去对比谁好谁坏，各位自行抉择。",-1),H=e("p",null,"我将权限管理分为三块：",-1),P=e("ol",null,[e("li",null,[e("strong",null,"资源权限"),n(" ：将url当做资源，可以给每个账号动态划分Url权限，访问不同的URl；")]),e("li",null,[e("strong",null,"操作权限"),n(" ：将所有URL分为增、删、改、查4种操作权限，给用户分配对应的操作权限，如某个用户只有查操作权限那么他就无法做其他的操作；")]),e("li",null,[e("strong",null,"角色权限"),n(" ：系统有多个角色，每个角色的权限都不同，如一个管理后台有着账号管理模块、商品模块等，为超级管理员的角色就可以看到所有模块并操作，而为售后的角色就只能看到商品模块，即使他知道账号管理模块下的URL也无权限操作。然后为用户设置角色就有对应的权限；")])],-1),V=e("p",null,"“",-1),B=e("p",null,"推荐下自己做的 Spring Boot 的实战项目：",-1),O={href:"https://github.com/YunaiV/ruoyi-vue-pro",target:"_blank",rel:"noopener noreferrer"},Y={id:"资源权限",tabindex:"-1"},D=e("a",{class:"header-anchor",href:"#资源权限","aria-hidden":"true"},"#",-1),W={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},j={id:"_1-静态资源准备",tabindex:"-1"},F=e("a",{class:"header-anchor",href:"#_1-静态资源准备","aria-hidden":"true"},"#",-1),G={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},J=r(`<p>这里方便演示就不直接操作数据库了，对应的权限建表关系也很简单，这里直接建立静态的用户对应的URL关系。</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>public class Constant {
    /**
     * 权限管理
     */
    public static Map&lt;Integer,String[]&gt; permission=new HashMap&lt;&gt;();
    static {
        String[] frist={&quot;/url1&quot;,&quot;/url2&quot;,&quot;/url3&quot;,&quot;/url4&quot;,&quot;/url5&quot;,&quot;/url6&quot;,&quot;/url7&quot;};//用户1所拥有的URL权限
        String[] second={&quot;/url1&quot;,&quot;/url2&quot;,&quot;/url3&quot;,&quot;/url4&quot;,&quot;/url5&quot;};//用户2所拥有的URL权限
        String[] third={&quot;/url1&quot;,&quot;/url2&quot;,&quot;/url3&quot;};//用户3所拥有的URL权限
        permission.put(1,frist);
        permission.put(2,second);
        permission.put(3,third);

    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),K={id:"_2-自定义一个异常-便于拦截抛出",tabindex:"-1"},Q=e("a",{class:"header-anchor",href:"#_2-自定义一个异常-便于拦截抛出","aria-hidden":"true"},"#",-1),X={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Z=r(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>public class APIException extends RuntimeException {
    private static final long serialVersionUID = 1L;
    private String msg;
    public APIException(String msg) {
        super(msg);
        this.msg = msg;
    }

}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),$={id:"_3-全局异常处理",tabindex:"-1"},ee=e("a",{class:"header-anchor",href:"#_3-全局异常处理","aria-hidden":"true"},"#",-1),ne={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ie=r(`<p>便于异常后返回统一规范的结果,正常应该是正常返回自定义Vo，但这里目标是为了演示结果，再加上各位应该都有自己的Vo类，所以这里就不用了</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>@RestControllerAdvice
public class WebExceptionControl {
    
    @ExceptionHandler(APIException.class)
    public String APIExceptionHandler(APIException e) {
        return e.getMessage();
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),te={id:"_4-controller层",tabindex:"-1"},re=e("a",{class:"header-anchor",href:"#_4-controller层","aria-hidden":"true"},"#",-1),se={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},de=e("p",null,"很简单创建对应的URL就好",-1),ae=e("figure",null,[e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241051.webp",alt:"图片",tabindex:"0",loading:"lazy"}),e("figcaption",null,"图片")],-1),le={id:"_5-拦截器创建",tabindex:"-1"},ce=e("a",{class:"header-anchor",href:"#_5-拦截器创建","aria-hidden":"true"},"#",-1),oe={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},fe=r(`<p>一般是要先验证token，后根据token取到用户对应信息，这里没有登录所以就直接在token里传对应用户的key值了</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/**
 * 权限管理URL拦截器
 */
public class URLInterceptor implements HandlerInterceptor {

    // 预处理回调方法，在接口调用之前使用  true代表放行  false代表不放行
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
        HttpServletRequest httpServletRequest = (HttpServletRequest) request;
        String token = httpServletRequest.getHeader(&quot;token&quot;);
        String requestURL = httpServletRequest.getRequestURI();
        //1.根据token判断用户是否登录
        if (token==null){   //正常情况下这里还需判断与redis中的token是否匹配
            // 如果没有token或者token不匹配, 直接抛出异常  提示未登录
            throw  new APIException(&quot;当前用户未登录&quot;);
        }
        //2.登录成功后 根据用户token中的信息获取到用户对应的URL权限集合
        String[] strings = Constant.permission.get(Integer.valueOf(token));
        boolean hasPermission = false;
        //3.再根据用户对应的URL集合去与当前请求的URL对比  有匹配的则放行  反之则抛出异常
        for (int i =0;i&lt;strings.length;i++) {
            if (strings[i].equals(requestURL)){
                hasPermission = true;
                break;
            }
        }
        if (hasPermission){
            return true;
        }else {
            throw  new APIException(&quot;当前用户没有访问路径&quot; + requestURL + &quot;的权限&quot;);
        }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),_e={id:"_6-将拦截器注入应用",tabindex:"-1"},he=e("a",{class:"header-anchor",href:"#_6-将拦截器注入应用","aria-hidden":"true"},"#",-1),be={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ue=r(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>@Configuration
public class WebMvcConfg implements WebMvcConfigurer {

    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        //权限拦截器
        registry.addInterceptor(urlInterceptor()).addPathPatterns(&quot;/**&quot;);
    }
    @Bean
    public URLInterceptor urlInterceptor(){
        return new URLInterceptor();
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),me={id:"_7-验证查看结果",tabindex:"-1"},pe=e("a",{class:"header-anchor",href:"#_7-验证查看结果","aria-hidden":"true"},"#",-1),ge={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ve=e("p",null,"分别在token中传入用户1-3的key，访问不同url就可以看到效果，如下",-1),xe={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ze=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241052.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),qe=e("figcaption",null,"图片",-1),Me={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},we=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241053.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),Ue=e("figcaption",null,"图片",-1),Ne=e("p",null,"“",-1),ke=e("p",null,"推荐下自己做的 Spring Cloud 的实战项目：",-1),Te={href:"https://github.com/YunaiV/onemall",target:"_blank",rel:"noopener noreferrer"},Ae={id:"操作权限",tabindex:"-1"},Ie=e("a",{class:"header-anchor",href:"#操作权限","aria-hidden":"true"},"#",-1),Re={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Se={id:"_1-和上面一样使用静态资源",tabindex:"-1"},ye=e("a",{class:"header-anchor",href:"#_1-和上面一样使用静态资源","aria-hidden":"true"},"#",-1),Ce={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Le=r(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>public class Constant {
    /**
     * 权限管理
     */
    public static Map&lt;Integer,String[]&gt; permission=new HashMap&lt;&gt;();
    static {
        String[] frist={&quot;insert&quot;,&quot;delete&quot;,&quot;select&quot;,&quot;update&quot;};//用户1所拥有的操作权限
        String[] second={&quot;insert&quot;,&quot;select&quot;,&quot;update&quot;};//用户2所拥有的URL权限
        String[] third={&quot;select&quot;};//用户3所拥有的URL权限
        permission.put(1,frist);
        permission.put(2,second);
        permission.put(3,third);

    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Ee={id:"_2-自定义注解",tabindex:"-1"},He=e("a",{class:"header-anchor",href:"#_2-自定义注解","aria-hidden":"true"},"#",-1),Pe={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Ve=r(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface UrlAnnotation {
    /**
     * 操作类型(type):添加,删除,修改,插入
     * 
     */
    String type();
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Be={id:"_3-controller层",tabindex:"-1"},Oe=e("a",{class:"header-anchor",href:"#_3-controller层","aria-hidden":"true"},"#",-1),Ye={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},De=e("p",null,"打上自定义的注解，代表对应方法是什么操作",-1),We={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},je=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241054.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),Fe=e("figcaption",null,"图片",-1),Ge={id:"_4-修改一下之前的拦截器",tabindex:"-1"},Je=e("a",{class:"header-anchor",href:"#_4-修改一下之前的拦截器","aria-hidden":"true"},"#",-1),Ke={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Qe=e("p",null,"添加对注解上面的操作类型的获取，并用type类型去对比判断",-1),Xe={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Ze=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241055.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),$e=e("figcaption",null,"图片",-1),en={id:"_5-验证结果",tabindex:"-1"},nn=e("a",{class:"header-anchor",href:"#_5-验证结果","aria-hidden":"true"},"#",-1),tn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},rn=e("p",null,"其他都不变",-1),sn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},dn=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241056.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),an=e("figcaption",null,"图片",-1),ln={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},cn=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241157.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),on=e("figcaption",null,"图片",-1),fn={id:"角色权限",tabindex:"-1"},_n=e("a",{class:"header-anchor",href:"#角色权限","aria-hidden":"true"},"#",-1),hn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},bn=e("p",null,"这里其实和上面的操作大同小异，我这里简单演示一下，以两个模块为例",-1),un={id:"_1-静态对应关系",tabindex:"-1"},mn=e("a",{class:"header-anchor",href:"#_1-静态对应关系","aria-hidden":"true"},"#",-1),pn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},gn=r(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>public class Constant {
    /**
     * 权限管理
     */
    public static Map&lt;Integer,String[]&gt; permission=new HashMap&lt;&gt;();
    static {
        String[] frist={&quot;test&quot;,&quot;test1&quot;};//用户1所拥有的模块权限  这里的test是模块URL入口  例如：test模块下所有URL都是/test/**
        String[] second={&quot;test&quot;};//用户2所拥有的模块权限
        permission.put(1,frist); //这里的1其实是用户对应ID为1的角色
        permission.put(2,second);//这个2同理

    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),vn={id:"_2-修改controller",tabindex:"-1"},xn=e("a",{class:"header-anchor",href:"#_2-修改controller","aria-hidden":"true"},"#",-1),zn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},qn=e("p",null,"模拟两个模块",-1),Mn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},wn=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241158.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),Un=e("figcaption",null,"图片",-1),Nn={id:"_3-修改一下拦截器",tabindex:"-1"},kn=e("a",{class:"header-anchor",href:"#_3-修改一下拦截器","aria-hidden":"true"},"#",-1),Tn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},An={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},In=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241159.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),Rn=e("figcaption",null,"图片",-1),Sn={id:"_4-结果测试",tabindex:"-1"},yn=e("a",{class:"header-anchor",href:"#_4-结果测试","aria-hidden":"true"},"#",-1),Cn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Ln={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},En=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241160.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),Hn=e("figcaption",null,"图片",-1),Pn={id:"总结",tabindex:"-1"},Vn=e("a",{class:"header-anchor",href:"#总结","aria-hidden":"true"},"#",-1),Bn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},On=e("p",null,"其实用自定义的拦截器去做权限，不管是什么类型其实都大同小异，根据需求灵活的去处理才是最重要的，上面的静态权限变通一下，建立角色表、用户表、路径表以及对应关系，就很容易做出URL的动态权限配置了，灵活运用自定义注解搭配可以做到更细致。",-1);function Yn(Dn,Wn){const i=d("ExternalLinkIcon");return a(),l("div",null,[o,e("ul",null,[e("li",null,[e("p",null,[e("a",f,[n("前言"),t(i)])])]),e("li",null,[e("p",null,[e("a",_,[n("资源权限"),t(i)])])]),e("li",null,[e("ul",null,[e("li",null,[e("a",h,[n("1.静态资源准备"),t(i)])]),e("li",null,[e("a",b,[n("2.自定义一个异常，便于拦截抛出"),t(i)])]),e("li",null,[e("a",u,[n("3.全局异常处理"),t(i)])]),e("li",null,[e("a",m,[n("4.controller层"),t(i)])]),e("li",null,[e("a",p,[n("5.拦截器创建"),t(i)])]),e("li",null,[e("a",g,[n("6.将拦截器注入应用"),t(i)])]),e("li",null,[e("a",v,[n("7.验证查看结果"),t(i)])])])]),e("li",null,[e("p",null,[e("a",x,[n("操作权限"),t(i)])])]),e("li",null,[e("ul",null,[e("li",null,[e("a",z,[n("1.和上面一样使用静态资源"),t(i)])]),e("li",null,[e("a",q,[n("2.自定义注解"),t(i)])]),e("li",null,[e("a",M,[n("3.controller层"),t(i)])]),e("li",null,[e("a",w,[n("4.修改一下之前的拦截器"),t(i)])]),e("li",null,[e("a",U,[n("5.验证结果"),t(i)])])])]),e("li",null,[e("p",null,[e("a",N,[n("角色权限"),t(i)])])]),e("li",null,[e("ul",null,[e("li",null,[e("a",k,[n("1.静态对应关系"),t(i)])]),e("li",null,[e("a",T,[n("2.修改controller"),t(i)])]),e("li",null,[e("a",A,[n("3.修改一下拦截器"),t(i)])]),e("li",null,[e("a",I,[n("4.结果测试"),t(i)])])])]),e("li",null,[e("p",null,[e("a",R,[n("总结"),t(i)])])])]),S,e("h2",y,[C,n(),e("a",L,[n("前言"),t(i)])]),E,H,P,e("blockquote",null,[V,B,e("p",null,[e("a",O,[n("https://github.com/YunaiV/ruoyi-vue-pro"),t(i)])])]),e("h2",Y,[D,n(),e("a",W,[n("资源权限"),t(i)])]),e("h3",j,[F,n(),e("a",G,[n("1.静态资源准备"),t(i)])]),J,e("h3",K,[Q,n(),e("a",X,[n("2.自定义一个异常，便于拦截抛出"),t(i)])]),Z,e("h3",$,[ee,n(),e("a",ne,[n("3.全局异常处理"),t(i)])]),ie,e("h3",te,[re,n(),e("a",se,[n("4.controller层"),t(i)])]),de,ae,e("h3",le,[ce,n(),e("a",oe,[n("5.拦截器创建"),t(i)])]),fe,e("h3",_e,[he,n(),e("a",be,[n("6.将拦截器注入应用"),t(i)])]),ue,e("h3",me,[pe,n(),e("a",ge,[n("7.验证查看结果"),t(i)])]),ve,e("figure",null,[e("a",xe,[ze,t(i)]),qe]),e("figure",null,[e("a",Me,[we,t(i)]),Ue]),e("blockquote",null,[Ne,ke,e("p",null,[e("a",Te,[n("https://github.com/YunaiV/onemall"),t(i)])])]),e("h2",Ae,[Ie,n(),e("a",Re,[n("操作权限"),t(i)])]),e("h3",Se,[ye,n(),e("a",Ce,[n("1.和上面一样使用静态资源"),t(i)])]),Le,e("h3",Ee,[He,n(),e("a",Pe,[n("2.自定义注解"),t(i)])]),Ve,e("h3",Be,[Oe,n(),e("a",Ye,[n("3.controller层"),t(i)])]),De,e("figure",null,[e("a",We,[je,t(i)]),Fe]),e("h3",Ge,[Je,n(),e("a",Ke,[n("4.修改一下之前的拦截器"),t(i)])]),Qe,e("figure",null,[e("a",Xe,[Ze,t(i)]),$e]),e("h3",en,[nn,n(),e("a",tn,[n("5.验证结果"),t(i)])]),rn,e("figure",null,[e("a",sn,[dn,t(i)]),an]),e("figure",null,[e("a",ln,[cn,t(i)]),on]),e("h2",fn,[_n,n(),e("a",hn,[n("角色权限"),t(i)])]),bn,e("h3",un,[mn,n(),e("a",pn,[n("1.静态对应关系"),t(i)])]),gn,e("h3",vn,[xn,n(),e("a",zn,[n("2.修改controller"),t(i)])]),qn,e("figure",null,[e("a",Mn,[wn,t(i)]),Un]),e("h3",Nn,[kn,n(),e("a",Tn,[n("3.修改一下拦截器"),t(i)])]),e("figure",null,[e("a",An,[In,t(i)]),Rn]),e("h3",Sn,[yn,n(),e("a",Cn,[n("4.结果测试"),t(i)])]),e("figure",null,[e("a",Ln,[En,t(i)]),Hn]),e("h2",Pn,[Vn,n(),e("a",Bn,[n("总结"),t(i)])]),On])}const Gn=s(c,[["render",Yn],["__file","SpringBoot.html.vue"]]);export{Gn as default};
