import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as s,o as a,c as o,d as e,e as i,b as p,a as r}from"./app-BRQZ0-Iq.js";const l={},c=e("h1",{id:"openresty-一键安装部署脚本",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#openresty-一键安装部署脚本"},[e("span",null,"openresty 一键安装部署脚本")])],-1),u=e("p",null,[e("strong",null,"openresty 的一些核心简介：")],-1),m=e("p",null,"openresty 是一个成熟的网络平台，它集成了标准的 Nginx 核心，LuaJIT，许多精心编写的 Lua 库，许多高质量的第三方 Nginx 模块以及大多数外部依赖项。",-1),d=e("li",null,"网站：http：//openresty.org/",-1),y=e("li",null,"Github 组织：https：//github.com/openresty",-1),E=e("li",null,"首席开发人员：@agentzh",-1),h=e("li",null,"国内最可利用的文档：",-1),_={href:"http://wiki.jikexueyuan.com/project/openresty/",target:"_blank",rel:"noopener noreferrer"},v=r(`<p><strong>一键安装部署脚本如下：</strong></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># 第一个参数为 OpenResty 的版本号VERSION=$1OPENRESTY_FILE=&quot;openresty-\${VERSION}.tar.gz&quot;OPENRESTY_URL=&quot;https://openresty.org/download/\${OPENRESTY_FILE}&quot;OPENRESTY_MD5_URL=&quot;\${OPENRESTY_URL}.md5&quot;INSTALL_DIR=&quot;/data/openresty&quot;</span>
<span class="token comment"># 检查 OpenResty 文件是否存在if [ ! -f &quot;$OPENRESTY_FILE&quot; ]; then  echo &quot;正在下载 \${OPENRESTY_URL}...&quot;  wget &quot;$OPENRESTY_URL&quot;</span>
  <span class="token comment"># 检查下载是否成功  if [ &quot;$?&quot; -ne 0 ]; then    echo &quot;下载 \${OPENRESTY_URL} 失败&quot;    exit 1  fifi</span>
<span class="token comment"># 检查 OpenResty 文件的 MD5echo &quot;正在获取 \${OPENRESTY_FILE} 的 MD5 值...&quot;wget &quot;$OPENRESTY_MD5_URL&quot;</span>
<span class="token comment"># 检查获取 MD5 文件是否成功if [ &quot;$?&quot; -ne 0 ]; then  echo &quot;获取 \${OPENRESTY_MD5_URL} 失败&quot;  exit 1fi</span>
<span class="token comment"># 提取 MD5 值并检查是否匹配EXPECTED_MD5=$(cat &quot;\${OPENRESTY_FILE}.md5&quot; | awk &#39;{ print $1 }&#39;)ACTUAL_MD5=$(md5sum &quot;$OPENRESTY_FILE&quot; | awk &#39;{ print $1 }&#39;)if [ &quot;$EXPECTED_MD5&quot; != &quot;$ACTUAL_MD5&quot; ]; then  echo &quot;下载的 \${OPENRESTY_FILE} 文件的 MD5 值不匹配&quot;  exit 1fi</span>
<span class="token comment"># 安装依赖yum install -y gcc make pcre-devel openssl-devel</span>
<span class="token comment"># 解压并编译安装 OpenRestytar -xzvf &quot;$OPENRESTY_FILE&quot;cd &quot;openresty-$VERSION&quot;./configure --prefix=&quot;$INSTALL_DIR&quot;makemake install</span>
<span class="token comment"># 检查安装是否成功if [ &quot;$?&quot; -ne 0 ]; then  echo &quot;OpenResty $VERSION 安装失败&quot;  exit 1fi</span>
<span class="token comment"># 添加 OpenResty 到环境变量echo &#39;export PATH=$PATH:&#39;&quot;$INSTALL_DIR/bin&quot;&#39;/&#39; &gt;&gt; /etc/profilesource /etc/profile</span>
<span class="token comment"># 创建 OpenResty 服务文件echo &quot;正在创建 OpenResty 服务文件...&quot;cat &lt;&lt;EOF &gt; /etc/systemd/system/openresty.service[Unit]Description=OpenResty HTTP ServerAfter=network.target</span>
<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>Type<span class="token operator">=</span>forkingPIDFile<span class="token operator">=</span>/run/openresty.pidExecStart<span class="token operator">=</span><span class="token variable">$INSTALL_DIR</span>/nginx/sbin/nginx <span class="token parameter variable">-c</span> <span class="token variable">$INSTALL_DIR</span>/nginx/conf/nginx.confExecReload<span class="token operator">=</span>/bin/kill <span class="token parameter variable">-s</span> HUP <span class="token punctuation">\\</span><span class="token variable">$MAINPIDExecStop</span><span class="token operator">=</span>/bin/kill <span class="token parameter variable">-s</span> QUIT <span class="token punctuation">\\</span><span class="token variable">$MAINPIDPrivateTmp</span><span class="token operator">=</span>true
<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>WantedBy<span class="token operator">=</span>multi-user.targetEOF
<span class="token comment"># 启动 OpenResty 服务systemctl daemon-reloadsystemctl enable openrestysystemctl start openresty</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;OpenResty <span class="token variable">$VERSION</span> 已安装到 <span class="token variable">$INSTALL_DIR</span>，并已启动 OpenResty 服务&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以使用执行脚本后带版本号执行安装相应版本的 openresty</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">sh</span> install_openresty.sh <span class="token number">1.19</span>.3.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,4);function g(b,k){const t=s("ExternalLinkIcon");return a(),o("div",null,[c,u,m,e("ul",null,[d,y,E,h,e("li",null,[e("a",_,[i("http://wiki.jikexueyuan.com/project/openresty/"),p(t)])])]),v])}const T=n(l,[["render",g],["__file","openresty一键安装部署脚本.html.vue"]]),x=JSON.parse('{"path":"/linux/openresty%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC.html","title":"openresty一键安装部署脚本","lang":"zh-CN","frontmatter":{"author":"xlc520","title":"openresty一键安装部署脚本","excerpt":null,"description":"openresty 一键安装部署脚本 openresty 的一些核心简介： openresty 是一个成熟的网络平台，它集成了标准的 Nginx 核心，LuaJIT，许多精心编写的 Lua 库，许多高质量的第三方 Nginx 模块以及大多数外部依赖项。 网站：http：//openresty.org/ Github 组织：https：//github....","date":"2023-04-10T00:00:00.000Z","category":"Linux","tag":["Linux","openresty"],"article":true,"timeline":true,"icon":"linux","head":[["meta",{"property":"og:url","content":"https://blog.ciberviler.top/linux/openresty%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC.html"}],["meta",{"property":"og:site_name","content":"StudyNote - 丰富的知识笔记库"}],["meta",{"property":"og:title","content":"openresty一键安装部署脚本"}],["meta",{"property":"og:description","content":"openresty 一键安装部署脚本 openresty 的一些核心简介： openresty 是一个成熟的网络平台，它集成了标准的 Nginx 核心，LuaJIT，许多精心编写的 Lua 库，许多高质量的第三方 Nginx 模块以及大多数外部依赖项。 网站：http：//openresty.org/ Github 组织：https：//github...."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-27T13:32:36.000Z"}],["meta",{"property":"article:author","content":"xlc520"}],["meta",{"property":"article:tag","content":"Linux"}],["meta",{"property":"article:tag","content":"openresty"}],["meta",{"property":"article:published_time","content":"2023-04-10T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-27T13:32:36.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"openresty一键安装部署脚本\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-04-10T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-27T13:32:36.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"xlc520\\"}]}"]]},"headers":[],"git":{"createdTime":1681887867000,"updatedTime":1714224756000,"contributors":[{"name":"xlc","email":"2215400217@qq.com","commits":1},{"name":"xlc520","email":"2215400217@qq.com","commits":1}]},"readingTime":{"minutes":1.53,"words":459},"filePathRelative":"linux/openresty一键安装部署脚本.md","localizedDate":"2023年4月10日","autoDesc":true}');export{T as comp,x as data};
