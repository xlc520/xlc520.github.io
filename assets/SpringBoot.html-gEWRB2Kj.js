import{_ as r}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as d,o as a,c as l,b as e,d as t,e as i,a as s}from"./app-aq8PVJpR.js";const c={},o=e("h1",{id:"springboot-拦截器-自定义异常-自定义注解-全局异常处理",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#springboot-拦截器-自定义异常-自定义注解-全局异常处理"},[e("span",null,"SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理")])],-1),f={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},_={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},h={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},b={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},u={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},m={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},p={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},g={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},v={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},x={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},z={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},q={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},M={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},w={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},U={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},N={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},k={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},T={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},A={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},I={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},R={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},S=e("hr",null,null,-1),y={id:"前言",tabindex:"-1"},C={class:"header-anchor",href:"#前言"},L={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},E=s("<p>提到权限管理这块肯定很多人第一想到的就是Springboot Security或者是Shiro安全框架，但本文介绍的并不是这两种，不是因为他们不好用，实在是自己太懒了，我觉得一个拦截器加上其他的一些处理就能满足项目的需求，我又何必去多用一个框架呢，这篇文章也不是去对比谁好谁坏，各位自行抉择。</p><p>我将权限管理分为三块：</p><ol><li><strong>资源权限</strong> ：将url当做资源，可以给每个账号动态划分Url权限，访问不同的URl；</li><li><strong>操作权限</strong> ：将所有URL分为增、删、改、查4种操作权限，给用户分配对应的操作权限，如某个用户只有查操作权限那么他就无法做其他的操作；</li><li><strong>角色权限</strong> ：系统有多个角色，每个角色的权限都不同，如一个管理后台有着账号管理模块、商品模块等，为超级管理员的角色就可以看到所有模块并操作，而为售后的角色就只能看到商品模块，即使他知道账号管理模块下的URL也无权限操作。然后为用户设置角色就有对应的权限；</li></ol><blockquote><p>“</p><p>推荐下自己做的 Spring Boot 的实战项目：</p><p>https://github.com/YunaiV/ruoyi-vue-pro</p></blockquote>",4),H={id:"资源权限",tabindex:"-1"},P={class:"header-anchor",href:"#资源权限"},V={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},B={id:"_1-静态资源准备",tabindex:"-1"},O={class:"header-anchor",href:"#_1-静态资源准备"},D={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},W=s(`<p>这里方便演示就不直接操作数据库了，对应的权限建表关系也很简单，这里直接建立静态的用户对应的URL关系。</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>public class Constant {
    /**
     * 权限管理
     */
    public static Map&lt;Integer,String[]&gt; permission=new HashMap&lt;&gt;();
    static {
        String[] frist={&quot;/url1&quot;,&quot;/url2&quot;,&quot;/url3&quot;,&quot;/url4&quot;,&quot;/url5&quot;,&quot;/url6&quot;,&quot;/url7&quot;};//用户1所拥有的URL权限
        String[] second={&quot;/url1&quot;,&quot;/url2&quot;,&quot;/url3&quot;,&quot;/url4&quot;,&quot;/url5&quot;};//用户2所拥有的URL权限
        String[] third={&quot;/url1&quot;,&quot;/url2&quot;,&quot;/url3&quot;};//用户3所拥有的URL权限
        permission.put(1,frist);
        permission.put(2,second);
        permission.put(3,third);

    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),Y={id:"_2-自定义一个异常-便于拦截抛出",tabindex:"-1"},j={class:"header-anchor",href:"#_2-自定义一个异常-便于拦截抛出"},F={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},G=s(`<div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>public class APIException extends RuntimeException {
    private static final long serialVersionUID = 1L;
    private String msg;
    public APIException(String msg) {
        super(msg);
        this.msg = msg;
    }

}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),J={id:"_3-全局异常处理",tabindex:"-1"},K={class:"header-anchor",href:"#_3-全局异常处理"},Q={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},X=s(`<p>便于异常后返回统一规范的结果,正常应该是正常返回自定义Vo，但这里目标是为了演示结果，再加上各位应该都有自己的Vo类，所以这里就不用了</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>@RestControllerAdvice
public class WebExceptionControl {
    
    @ExceptionHandler(APIException.class)
    public String APIExceptionHandler(APIException e) {
        return e.getMessage();
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),Z={id:"_4-controller层",tabindex:"-1"},$={class:"header-anchor",href:"#_4-controller层"},ee={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ne=e("p",null,"很简单创建对应的URL就好",-1),ie=e("figure",null,[e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241051.webp",alt:"图片",tabindex:"0",loading:"lazy"}),e("figcaption",null,"图片")],-1),te={id:"_5-拦截器创建",tabindex:"-1"},se={class:"header-anchor",href:"#_5-拦截器创建"},re={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},de=s(`<p>一般是要先验证token，后根据token取到用户对应信息，这里没有登录所以就直接在token里传对应用户的key值了</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>/**
 * 权限管理URL拦截器
 */
public class URLInterceptor implements HandlerInterceptor {

    // 预处理回调方法，在接口调用之前使用  true代表放行  false代表不放行
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
        HttpServletRequest httpServletRequest = (HttpServletRequest) request;
        String token = httpServletRequest.getHeader(&quot;token&quot;);
        String requestURL = httpServletRequest.getRequestURI();
        //1.根据token判断用户是否登录
        if (token==null){   //正常情况下这里还需判断与redis中的token是否匹配
            // 如果没有token或者token不匹配, 直接抛出异常  提示未登录
            throw  new APIException(&quot;当前用户未登录&quot;);
        }
        //2.登录成功后 根据用户token中的信息获取到用户对应的URL权限集合
        String[] strings = Constant.permission.get(Integer.valueOf(token));
        boolean hasPermission = false;
        //3.再根据用户对应的URL集合去与当前请求的URL对比  有匹配的则放行  反之则抛出异常
        for (int i =0;i&lt;strings.length;i++) {
            if (strings[i].equals(requestURL)){
                hasPermission = true;
                break;
            }
        }
        if (hasPermission){
            return true;
        }else {
            throw  new APIException(&quot;当前用户没有访问路径&quot; + requestURL + &quot;的权限&quot;);
        }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),ae={id:"_6-将拦截器注入应用",tabindex:"-1"},le={class:"header-anchor",href:"#_6-将拦截器注入应用"},ce={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},oe=s(`<div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>@Configuration
public class WebMvcConfg implements WebMvcConfigurer {

    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        //权限拦截器
        registry.addInterceptor(urlInterceptor()).addPathPatterns(&quot;/**&quot;);
    }
    @Bean
    public URLInterceptor urlInterceptor(){
        return new URLInterceptor();
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),fe={id:"_7-验证查看结果",tabindex:"-1"},_e={class:"header-anchor",href:"#_7-验证查看结果"},he={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},be=e("p",null,"分别在token中传入用户1-3的key，访问不同url就可以看到效果，如下",-1),ue={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},me=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241052.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),pe=e("figcaption",null,"图片",-1),ge={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ve=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241053.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),xe=e("figcaption",null,"图片",-1),ze=e("blockquote",null,[e("p",null,"“"),e("p",null,"推荐下自己做的 Spring Cloud 的实战项目："),e("p",null,"https://github.com/YunaiV/onemall")],-1),qe={id:"操作权限",tabindex:"-1"},Me={class:"header-anchor",href:"#操作权限"},we={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Ue={id:"_1-和上面一样使用静态资源",tabindex:"-1"},Ne={class:"header-anchor",href:"#_1-和上面一样使用静态资源"},ke={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Te=s(`<div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>public class Constant {
    /**
     * 权限管理
     */
    public static Map&lt;Integer,String[]&gt; permission=new HashMap&lt;&gt;();
    static {
        String[] frist={&quot;insert&quot;,&quot;delete&quot;,&quot;select&quot;,&quot;update&quot;};//用户1所拥有的操作权限
        String[] second={&quot;insert&quot;,&quot;select&quot;,&quot;update&quot;};//用户2所拥有的URL权限
        String[] third={&quot;select&quot;};//用户3所拥有的URL权限
        permission.put(1,frist);
        permission.put(2,second);
        permission.put(3,third);

    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Ae={id:"_2-自定义注解",tabindex:"-1"},Ie={class:"header-anchor",href:"#_2-自定义注解"},Re={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Se=s(`<div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface UrlAnnotation {
    /**
     * 操作类型(type):添加,删除,修改,插入
     * 
     */
    String type();
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),ye={id:"_3-controller层",tabindex:"-1"},Ce={class:"header-anchor",href:"#_3-controller层"},Le={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Ee=e("p",null,"打上自定义的注解，代表对应方法是什么操作",-1),He={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Pe=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241054.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),Ve=e("figcaption",null,"图片",-1),Be={id:"_4-修改一下之前的拦截器",tabindex:"-1"},Oe={class:"header-anchor",href:"#_4-修改一下之前的拦截器"},De={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},We=e("p",null,"添加对注解上面的操作类型的获取，并用type类型去对比判断",-1),Ye={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},je=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241055.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),Fe=e("figcaption",null,"图片",-1),Ge={id:"_5-验证结果",tabindex:"-1"},Je={class:"header-anchor",href:"#_5-验证结果"},Ke={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Qe=e("p",null,"其他都不变",-1),Xe={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Ze=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241056.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),$e=e("figcaption",null,"图片",-1),en={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},nn=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241157.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),tn=e("figcaption",null,"图片",-1),sn={id:"角色权限",tabindex:"-1"},rn={class:"header-anchor",href:"#角色权限"},dn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},an=e("p",null,"这里其实和上面的操作大同小异，我这里简单演示一下，以两个模块为例",-1),ln={id:"_1-静态对应关系",tabindex:"-1"},cn={class:"header-anchor",href:"#_1-静态对应关系"},on={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},fn=s(`<div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>public class Constant {
    /**
     * 权限管理
     */
    public static Map&lt;Integer,String[]&gt; permission=new HashMap&lt;&gt;();
    static {
        String[] frist={&quot;test&quot;,&quot;test1&quot;};//用户1所拥有的模块权限  这里的test是模块URL入口  例如：test模块下所有URL都是/test/**
        String[] second={&quot;test&quot;};//用户2所拥有的模块权限
        permission.put(1,frist); //这里的1其实是用户对应ID为1的角色
        permission.put(2,second);//这个2同理

    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),_n={id:"_2-修改controller",tabindex:"-1"},hn={class:"header-anchor",href:"#_2-修改controller"},bn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},un=e("p",null,"模拟两个模块",-1),mn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},pn=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241158.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),gn=e("figcaption",null,"图片",-1),vn={id:"_3-修改一下拦截器",tabindex:"-1"},xn={class:"header-anchor",href:"#_3-修改一下拦截器"},zn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},qn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Mn=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241159.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),wn=e("figcaption",null,"图片",-1),Un={id:"_4-结果测试",tabindex:"-1"},Nn={class:"header-anchor",href:"#_4-结果测试"},kn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Tn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},An=e("img",{src:"https://gh.xlc520.tk/xlc520/MyImage/raw/main/MdImg/640-164346343241160.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),In=e("figcaption",null,"图片",-1),Rn={id:"总结",tabindex:"-1"},Sn={class:"header-anchor",href:"#总结"},yn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Cn=e("p",null,"其实用自定义的拦截器去做权限，不管是什么类型其实都大同小异，根据需求灵活的去处理才是最重要的，上面的静态权限变通一下，建立角色表、用户表、路径表以及对应关系，就很容易做出URL的动态权限配置了，灵活运用自定义注解搭配可以做到更细致。",-1);function Ln(En,Hn){const n=d("ExternalLinkIcon");return a(),l("div",null,[o,e("ul",null,[e("li",null,[e("p",null,[e("a",f,[t("前言"),i(n)])])]),e("li",null,[e("p",null,[e("a",_,[t("资源权限"),i(n)])])]),e("li",null,[e("ul",null,[e("li",null,[e("a",h,[t("1.静态资源准备"),i(n)])]),e("li",null,[e("a",b,[t("2.自定义一个异常，便于拦截抛出"),i(n)])]),e("li",null,[e("a",u,[t("3.全局异常处理"),i(n)])]),e("li",null,[e("a",m,[t("4.controller层"),i(n)])]),e("li",null,[e("a",p,[t("5.拦截器创建"),i(n)])]),e("li",null,[e("a",g,[t("6.将拦截器注入应用"),i(n)])]),e("li",null,[e("a",v,[t("7.验证查看结果"),i(n)])])])]),e("li",null,[e("p",null,[e("a",x,[t("操作权限"),i(n)])])]),e("li",null,[e("ul",null,[e("li",null,[e("a",z,[t("1.和上面一样使用静态资源"),i(n)])]),e("li",null,[e("a",q,[t("2.自定义注解"),i(n)])]),e("li",null,[e("a",M,[t("3.controller层"),i(n)])]),e("li",null,[e("a",w,[t("4.修改一下之前的拦截器"),i(n)])]),e("li",null,[e("a",U,[t("5.验证结果"),i(n)])])])]),e("li",null,[e("p",null,[e("a",N,[t("角色权限"),i(n)])])]),e("li",null,[e("ul",null,[e("li",null,[e("a",k,[t("1.静态对应关系"),i(n)])]),e("li",null,[e("a",T,[t("2.修改controller"),i(n)])]),e("li",null,[e("a",A,[t("3.修改一下拦截器"),i(n)])]),e("li",null,[e("a",I,[t("4.结果测试"),i(n)])])])]),e("li",null,[e("p",null,[e("a",R,[t("总结"),i(n)])])])]),S,e("h2",y,[e("a",C,[e("span",null,[e("a",L,[t("前言"),i(n)])])])]),E,e("h2",H,[e("a",P,[e("span",null,[e("a",V,[t("资源权限"),i(n)])])])]),e("h3",B,[e("a",O,[e("span",null,[e("a",D,[t("1.静态资源准备"),i(n)])])])]),W,e("h3",Y,[e("a",j,[e("span",null,[e("a",F,[t("2.自定义一个异常，便于拦截抛出"),i(n)])])])]),G,e("h3",J,[e("a",K,[e("span",null,[e("a",Q,[t("3.全局异常处理"),i(n)])])])]),X,e("h3",Z,[e("a",$,[e("span",null,[e("a",ee,[t("4.controller层"),i(n)])])])]),ne,ie,e("h3",te,[e("a",se,[e("span",null,[e("a",re,[t("5.拦截器创建"),i(n)])])])]),de,e("h3",ae,[e("a",le,[e("span",null,[e("a",ce,[t("6.将拦截器注入应用"),i(n)])])])]),oe,e("h3",fe,[e("a",_e,[e("span",null,[e("a",he,[t("7.验证查看结果"),i(n)])])])]),be,e("figure",null,[e("a",ue,[me,i(n)]),pe]),e("figure",null,[e("a",ge,[ve,i(n)]),xe]),ze,e("h2",qe,[e("a",Me,[e("span",null,[e("a",we,[t("操作权限"),i(n)])])])]),e("h3",Ue,[e("a",Ne,[e("span",null,[e("a",ke,[t("1.和上面一样使用静态资源"),i(n)])])])]),Te,e("h3",Ae,[e("a",Ie,[e("span",null,[e("a",Re,[t("2.自定义注解"),i(n)])])])]),Se,e("h3",ye,[e("a",Ce,[e("span",null,[e("a",Le,[t("3.controller层"),i(n)])])])]),Ee,e("figure",null,[e("a",He,[Pe,i(n)]),Ve]),e("h3",Be,[e("a",Oe,[e("span",null,[e("a",De,[t("4.修改一下之前的拦截器"),i(n)])])])]),We,e("figure",null,[e("a",Ye,[je,i(n)]),Fe]),e("h3",Ge,[e("a",Je,[e("span",null,[e("a",Ke,[t("5.验证结果"),i(n)])])])]),Qe,e("figure",null,[e("a",Xe,[Ze,i(n)]),$e]),e("figure",null,[e("a",en,[nn,i(n)]),tn]),e("h2",sn,[e("a",rn,[e("span",null,[e("a",dn,[t("角色权限"),i(n)])])])]),an,e("h3",ln,[e("a",cn,[e("span",null,[e("a",on,[t("1.静态对应关系"),i(n)])])])]),fn,e("h3",_n,[e("a",hn,[e("span",null,[e("a",bn,[t("2.修改controller"),i(n)])])])]),un,e("figure",null,[e("a",mn,[pn,i(n)]),gn]),e("h3",vn,[e("a",xn,[e("span",null,[e("a",zn,[t("3.修改一下拦截器"),i(n)])])])]),e("figure",null,[e("a",qn,[Mn,i(n)]),wn]),e("h3",Un,[e("a",Nn,[e("span",null,[e("a",kn,[t("4.结果测试"),i(n)])])])]),e("figure",null,[e("a",Tn,[An,i(n)]),In]),e("h2",Rn,[e("a",Sn,[e("span",null,[e("a",yn,[t("总结"),i(n)])])])]),Cn])}const Bn=r(c,[["render",Ln],["__file","SpringBoot.html.vue"]]);export{Bn as default};
