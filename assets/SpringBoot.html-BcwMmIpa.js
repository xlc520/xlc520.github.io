import{_ as r}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as l,o as a,c as d,d as e,e as t,b as i,a as s}from"./app-BRQZ0-Iq.js";const o={},c=e("h1",{id:"springboot-拦截器-自定义异常-自定义注解-全局异常处理",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#springboot-拦截器-自定义异常-自定义注解-全局异常处理"},[e("span",null,"SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理")])],-1),f={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},_={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},b={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},h={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},u={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},p={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},m={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},g={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},v={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},x={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},z={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},q={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},k={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},w={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},N={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},U={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},T={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},M={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},A={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},S={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},y={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},R=e("hr",null,null,-1),C={id:"前言",tabindex:"-1"},I={class:"header-anchor",href:"#前言"},L={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},B=e("p",null,"提到权限管理这块肯定很多人第一想到的就是 Springboot Security 或者是 Shiro 安全框架，但本文介绍的并不是这两种，不是因为他们不好用，实在是自己太懒了，我觉得一个拦截器加上其他的一些处理就能满足项目的需求，我又何必去多用一个框架呢，这篇文章也不是去对比谁好谁坏，各位自行抉择。",-1),E=e("p",null,"我将权限管理分为三块：",-1),P=e("ol",null,[e("li",null,[e("strong",null,"资源权限"),t(" ：将 url 当做资源，可以给每个账号动态划分 Url 权限，访问不同的 URl；")]),e("li",null,[e("strong",null,"操作权限"),t(" ：将所有 URL 分为增、删、改、查 4 种操作权限，给用户分配对应的操作权限，如某个用户只有查操作权限那么他就无法做其他的操作；")]),e("li",null,[e("strong",null,"角色权限"),t(" ：系统有多个角色，每个角色的权限都不同，如一个管理后台有着账号管理模块、商品模块等，为超级管理员的角色就可以看到所有模块并操作，而为售后的角色就只能看到商品模块，即使他知道账号管理模块下的 URL 也无权限操作。然后为用户设置角色就有对应的权限；")])],-1),H=e("p",null,"“",-1),V=e("p",null,"推荐下自己做的 Spring Boot 的实战项目：",-1),O={href:"https://github.com/YunaiV/ruoyi-vue-pro",target:"_blank",rel:"noopener noreferrer"},Z={id:"资源权限",tabindex:"-1"},j={class:"header-anchor",href:"#资源权限"},D={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Y={id:"_1-静态资源准备",tabindex:"-1"},W={class:"header-anchor",href:"#_1-静态资源准备"},J={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},F=s(`<p>这里方便演示就不直接操作数据库了，对应的权限建表关系也很简单，这里直接建立静态的用户对应的 URL 关系。</p><div class="language-plain line-numbers-mode" data-ext="plain" data-title="plain"><pre class="language-plain"><code>public class Constant {
    /**
     * 权限管理
     */
    public static Map&lt;Integer,String[]&gt; permission=new HashMap&lt;&gt;();
    static {
        String[] frist={&quot;/url1&quot;,&quot;/url2&quot;,&quot;/url3&quot;,&quot;/url4&quot;,&quot;/url5&quot;,&quot;/url6&quot;,&quot;/url7&quot;};//用户1所拥有的URL权限
        String[] second={&quot;/url1&quot;,&quot;/url2&quot;,&quot;/url3&quot;,&quot;/url4&quot;,&quot;/url5&quot;};//用户2所拥有的URL权限
        String[] third={&quot;/url1&quot;,&quot;/url2&quot;,&quot;/url3&quot;};//用户3所拥有的URL权限
        permission.put(1,frist);
        permission.put(2,second);
        permission.put(3,third);

    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),G={id:"_2-自定义一个异常-便于拦截抛出",tabindex:"-1"},K={class:"header-anchor",href:"#_2-自定义一个异常-便于拦截抛出"},Q={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},X=s(`<div class="language-plain line-numbers-mode" data-ext="plain" data-title="plain"><pre class="language-plain"><code>public class APIException extends RuntimeException {
    private static final long serialVersionUID = 1L;
    private String msg;
    public APIException(String msg) {
        super(msg);
        this.msg = msg;
    }

}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),$={id:"_3-全局异常处理",tabindex:"-1"},ee={class:"header-anchor",href:"#_3-全局异常处理"},ne={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ie=s(`<p>便于异常后返回统一规范的结果,正常应该是正常返回自定义 Vo，但这里目标是为了演示结果，再加上各位应该都有自己的 Vo 类，所以这里就不用了</p><div class="language-plain line-numbers-mode" data-ext="plain" data-title="plain"><pre class="language-plain"><code>@RestControllerAdvice
public class WebExceptionControl {
    
    @ExceptionHandler(APIException.class)
    public String APIExceptionHandler(APIException e) {
        return e.getMessage();
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),te={id:"_4-controller-层",tabindex:"-1"},se={class:"header-anchor",href:"#_4-controller-层"},re={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},le=e("p",null,"很简单创建对应的 URL 就好",-1),ae=e("figure",null,[e("img",{src:"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241051.webp",alt:"图片",tabindex:"0",loading:"lazy"}),e("figcaption",null,"图片")],-1),de={id:"_5-拦截器创建",tabindex:"-1"},oe={class:"header-anchor",href:"#_5-拦截器创建"},ce={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},fe=s(`<p>一般是要先验证 token，后根据 token 取到用户对应信息，这里没有登录所以就直接在 token 里传对应用户的 key 值了</p><div class="language-plain line-numbers-mode" data-ext="plain" data-title="plain"><pre class="language-plain"><code>/**
 * 权限管理URL拦截器
 */
public class URLInterceptor implements HandlerInterceptor {

    // 预处理回调方法，在接口调用之前使用  true代表放行  false代表不放行
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
        HttpServletRequest httpServletRequest = (HttpServletRequest) request;
        String token = httpServletRequest.getHeader(&quot;token&quot;);
        String requestURL = httpServletRequest.getRequestURI();
        //1.根据token判断用户是否登录
        if (token==null){   //正常情况下这里还需判断与redis中的token是否匹配
            // 如果没有token或者token不匹配, 直接抛出异常  提示未登录
            throw  new APIException(&quot;当前用户未登录&quot;);
        }
        //2.登录成功后 根据用户token中的信息获取到用户对应的URL权限集合
        String[] strings = Constant.permission.get(Integer.valueOf(token));
        boolean hasPermission = false;
        //3.再根据用户对应的URL集合去与当前请求的URL对比  有匹配的则放行  反之则抛出异常
        for (int i =0;i&lt;strings.length;i++) {
            if (strings[i].equals(requestURL)){
                hasPermission = true;
                break;
            }
        }
        if (hasPermission){
            return true;
        }else {
            throw  new APIException(&quot;当前用户没有访问路径&quot; + requestURL + &quot;的权限&quot;);
        }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),_e={id:"_6-将拦截器注入应用",tabindex:"-1"},be={class:"header-anchor",href:"#_6-将拦截器注入应用"},he={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ue=s(`<div class="language-plain line-numbers-mode" data-ext="plain" data-title="plain"><pre class="language-plain"><code>@Configuration
public class WebMvcConfg implements WebMvcConfigurer {

    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        //权限拦截器
        registry.addInterceptor(urlInterceptor()).addPathPatterns(&quot;/**&quot;);
    }
    @Bean
    public URLInterceptor urlInterceptor(){
        return new URLInterceptor();
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),pe={id:"_7-验证查看结果",tabindex:"-1"},me={class:"header-anchor",href:"#_7-验证查看结果"},ge={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ve=e("p",null,"分别在 token 中传入用户 1-3 的 key，访问不同 url 就可以看到效果，如下",-1),xe={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ze=e("img",{src:"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241052.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),qe=e("figcaption",null,"图片",-1),ke={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},we=e("img",{src:"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241053.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),Ne=e("figcaption",null,"图片",-1),Ue=e("p",null,"“",-1),Te=e("p",null,"推荐下自己做的 Spring Cloud 的实战项目：",-1),Me={href:"https://github.com/YunaiV/onemall",target:"_blank",rel:"noopener noreferrer"},Ae={id:"操作权限",tabindex:"-1"},Se={class:"header-anchor",href:"#操作权限"},ye={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Re={id:"_1-和上面一样使用静态资源",tabindex:"-1"},Ce={class:"header-anchor",href:"#_1-和上面一样使用静态资源"},Ie={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Le=s(`<div class="language-plain line-numbers-mode" data-ext="plain" data-title="plain"><pre class="language-plain"><code>public class Constant {
    /**
     * 权限管理
     */
    public static Map&lt;Integer,String[]&gt; permission=new HashMap&lt;&gt;();
    static {
        String[] frist={&quot;insert&quot;,&quot;delete&quot;,&quot;select&quot;,&quot;update&quot;};//用户1所拥有的操作权限
        String[] second={&quot;insert&quot;,&quot;select&quot;,&quot;update&quot;};//用户2所拥有的URL权限
        String[] third={&quot;select&quot;};//用户3所拥有的URL权限
        permission.put(1,frist);
        permission.put(2,second);
        permission.put(3,third);

    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Be={id:"_2-自定义注解",tabindex:"-1"},Ee={class:"header-anchor",href:"#_2-自定义注解"},Pe={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},He=s(`<div class="language-plain line-numbers-mode" data-ext="plain" data-title="plain"><pre class="language-plain"><code>@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface UrlAnnotation {
    /**
     * 操作类型(type):添加,删除,修改,插入
     * 
     */
    String type();
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Ve={id:"_3-controller-层",tabindex:"-1"},Oe={class:"header-anchor",href:"#_3-controller-层"},Ze={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},je=e("p",null,"打上自定义的注解，代表对应方法是什么操作",-1),De={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Ye=e("img",{src:"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241054.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),We=e("figcaption",null,"图片",-1),Je={id:"_4-修改一下之前的拦截器",tabindex:"-1"},Fe={class:"header-anchor",href:"#_4-修改一下之前的拦截器"},Ge={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Ke=e("p",null,"添加对注解上面的操作类型的获取，并用 type 类型去对比判断",-1),Qe={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Xe=e("img",{src:"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241055.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),$e=e("figcaption",null,"图片",-1),en={id:"_5-验证结果",tabindex:"-1"},nn={class:"header-anchor",href:"#_5-验证结果"},tn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},sn=e("p",null,"其他都不变",-1),rn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},ln=e("img",{src:"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241056.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),an=e("figcaption",null,"图片",-1),dn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},on=e("img",{src:"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241157.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),cn=e("figcaption",null,"图片",-1),fn={id:"角色权限",tabindex:"-1"},_n={class:"header-anchor",href:"#角色权限"},bn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},hn=e("p",null,"这里其实和上面的操作大同小异，我这里简单演示一下，以两个模块为例",-1),un={id:"_1-静态对应关系",tabindex:"-1"},pn={class:"header-anchor",href:"#_1-静态对应关系"},mn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},gn=s(`<div class="language-plain line-numbers-mode" data-ext="plain" data-title="plain"><pre class="language-plain"><code>public class Constant {
    /**
     * 权限管理
     */
    public static Map&lt;Integer,String[]&gt; permission=new HashMap&lt;&gt;();
    static {
        String[] frist={&quot;test&quot;,&quot;test1&quot;};//用户1所拥有的模块权限  这里的test是模块URL入口  例如：test模块下所有URL都是/test/**
        String[] second={&quot;test&quot;};//用户2所拥有的模块权限
        permission.put(1,frist); //这里的1其实是用户对应ID为1的角色
        permission.put(2,second);//这个2同理

    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),vn={id:"_2-修改-controller",tabindex:"-1"},xn={class:"header-anchor",href:"#_2-修改-controller"},zn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},qn=e("p",null,"模拟两个模块",-1),kn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},wn=e("img",{src:"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241158.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),Nn=e("figcaption",null,"图片",-1),Un={id:"_3-修改一下拦截器",tabindex:"-1"},Tn={class:"header-anchor",href:"#_3-修改一下拦截器"},Mn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},An={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Sn=e("img",{src:"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241159.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),yn=e("figcaption",null,"图片",-1),Rn={id:"_4-结果测试",tabindex:"-1"},Cn={class:"header-anchor",href:"#_4-结果测试"},In={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Ln={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},Bn=e("img",{src:"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241160.webp",alt:"图片",tabindex:"0",loading:"lazy"},null,-1),En=e("figcaption",null,"图片",-1),Pn={id:"总结",tabindex:"-1"},Hn={class:"header-anchor",href:"#总结"},Vn={href:"https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"},On=e("p",null,"其实用自定义的拦截器去做权限，不管是什么类型其实都大同小异，根据需求灵活的去处理才是最重要的，上面的静态权限变通一下，建立角色表、用户表、路径表以及对应关系，就很容易做出 URL 的动态权限配置了，灵活运用自定义注解搭配可以做到更细致。",-1);function Zn(jn,Dn){const n=l("ExternalLinkIcon");return a(),d("div",null,[c,e("ul",null,[e("li",null,[e("p",null,[e("a",f,[t("前言"),i(n)])])]),e("li",null,[e("p",null,[e("a",_,[t("资源权限"),i(n)])])]),e("li",null,[e("ul",null,[e("li",null,[e("a",b,[t("1.静态资源准备"),i(n)])]),e("li",null,[e("a",h,[t("2.自定义一个异常，便于拦截抛出"),i(n)])]),e("li",null,[e("a",u,[t("3.全局异常处理"),i(n)])]),e("li",null,[e("a",p,[t("4.controller 层"),i(n)])]),e("li",null,[e("a",m,[t("5.拦截器创建"),i(n)])]),e("li",null,[e("a",g,[t("6.将拦截器注入应用"),i(n)])]),e("li",null,[e("a",v,[t("7.验证查看结果"),i(n)])])])]),e("li",null,[e("p",null,[e("a",x,[t("操作权限"),i(n)])])]),e("li",null,[e("ul",null,[e("li",null,[e("a",z,[t("1.和上面一样使用静态资源"),i(n)])]),e("li",null,[e("a",q,[t("2.自定义注解"),i(n)])]),e("li",null,[e("a",k,[t("3.controller 层"),i(n)])]),e("li",null,[e("a",w,[t("4.修改一下之前的拦截器"),i(n)])]),e("li",null,[e("a",N,[t("5.验证结果"),i(n)])])])]),e("li",null,[e("p",null,[e("a",U,[t("角色权限"),i(n)])])]),e("li",null,[e("ul",null,[e("li",null,[e("a",T,[t("1.静态对应关系"),i(n)])]),e("li",null,[e("a",M,[t("2.修改 controller"),i(n)])]),e("li",null,[e("a",A,[t("3.修改一下拦截器"),i(n)])]),e("li",null,[e("a",S,[t("4.结果测试"),i(n)])])])]),e("li",null,[e("p",null,[e("a",y,[t("总结"),i(n)])])])]),R,e("h2",C,[e("a",I,[e("span",null,[e("a",L,[t("前言"),i(n)])])])]),B,E,P,e("blockquote",null,[H,V,e("p",null,[e("a",O,[t("https://github.com/YunaiV/ruoyi-vue-pro"),i(n)])])]),e("h2",Z,[e("a",j,[e("span",null,[e("a",D,[t("资源权限"),i(n)])])])]),e("h3",Y,[e("a",W,[e("span",null,[e("a",J,[t("1.静态资源准备"),i(n)])])])]),F,e("h3",G,[e("a",K,[e("span",null,[e("a",Q,[t("2.自定义一个异常，便于拦截抛出"),i(n)])])])]),X,e("h3",$,[e("a",ee,[e("span",null,[e("a",ne,[t("3.全局异常处理"),i(n)])])])]),ie,e("h3",te,[e("a",se,[e("span",null,[e("a",re,[t("4.controller 层"),i(n)])])])]),le,ae,e("h3",de,[e("a",oe,[e("span",null,[e("a",ce,[t("5.拦截器创建"),i(n)])])])]),fe,e("h3",_e,[e("a",be,[e("span",null,[e("a",he,[t("6.将拦截器注入应用"),i(n)])])])]),ue,e("h3",pe,[e("a",me,[e("span",null,[e("a",ge,[t("7.验证查看结果"),i(n)])])])]),ve,e("figure",null,[e("a",xe,[ze,i(n)]),qe]),e("figure",null,[e("a",ke,[we,i(n)]),Ne]),e("blockquote",null,[Ue,Te,e("p",null,[e("a",Me,[t("https://github.com/YunaiV/onemall"),i(n)])])]),e("h2",Ae,[e("a",Se,[e("span",null,[e("a",ye,[t("操作权限"),i(n)])])])]),e("h3",Re,[e("a",Ce,[e("span",null,[e("a",Ie,[t("1.和上面一样使用静态资源"),i(n)])])])]),Le,e("h3",Be,[e("a",Ee,[e("span",null,[e("a",Pe,[t("2.自定义注解"),i(n)])])])]),He,e("h3",Ve,[e("a",Oe,[e("span",null,[e("a",Ze,[t("3.controller 层"),i(n)])])])]),je,e("figure",null,[e("a",De,[Ye,i(n)]),We]),e("h3",Je,[e("a",Fe,[e("span",null,[e("a",Ge,[t("4.修改一下之前的拦截器"),i(n)])])])]),Ke,e("figure",null,[e("a",Qe,[Xe,i(n)]),$e]),e("h3",en,[e("a",nn,[e("span",null,[e("a",tn,[t("5.验证结果"),i(n)])])])]),sn,e("figure",null,[e("a",rn,[ln,i(n)]),an]),e("figure",null,[e("a",dn,[on,i(n)]),cn]),e("h2",fn,[e("a",_n,[e("span",null,[e("a",bn,[t("角色权限"),i(n)])])])]),hn,e("h3",un,[e("a",pn,[e("span",null,[e("a",mn,[t("1.静态对应关系"),i(n)])])])]),gn,e("h3",vn,[e("a",xn,[e("span",null,[e("a",zn,[t("2.修改 controller"),i(n)])])])]),qn,e("figure",null,[e("a",kn,[wn,i(n)]),Nn]),e("h3",Un,[e("a",Tn,[e("span",null,[e("a",Mn,[t("3.修改一下拦截器"),i(n)])])])]),e("figure",null,[e("a",An,[Sn,i(n)]),yn]),e("h3",Rn,[e("a",Cn,[e("span",null,[e("a",In,[t("4.结果测试"),i(n)])])])]),e("figure",null,[e("a",Ln,[Bn,i(n)]),En]),e("h2",Pn,[e("a",Hn,[e("span",null,[e("a",Vn,[t("总结"),i(n)])])])]),On])}const Jn=r(o,[["render",Zn],["__file","SpringBoot.html.vue"]]),Fn=JSON.parse('{"path":"/dev/SpringBoot.html","title":"SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理","lang":"zh-CN","frontmatter":{"author":"xlc520","title":"SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理","excerpt":null,"description":"SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理","date":"2022-01-15T00:00:00.000Z","category":"java","tag":"java,springboot","article":true,"timeline":true,"icon":"type","head":[["meta",{"property":"og:url","content":"https://blog.ciberviler.top/dev/SpringBoot.html"}],["meta",{"property":"og:site_name","content":"StudyNote - 丰富的知识笔记库"}],["meta",{"property":"og:title","content":"SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理"}],["meta",{"property":"og:description","content":"SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241051.webp"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-27T13:32:36.000Z"}],["meta",{"property":"article:author","content":"xlc520"}],["meta",{"property":"article:tag","content":"java,springboot"}],["meta",{"property":"article:published_time","content":"2022-01-15T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-27T13:32:36.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"SpringBoot+拦截器+自定义异常+自定义注解+全局异常处理\\",\\"image\\":[\\"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241051.webp\\",\\"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241052.webp\\",\\"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241053.webp\\",\\"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241054.webp\\",\\"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241055.webp\\",\\"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241056.webp\\",\\"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241157.webp\\",\\"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241158.webp\\",\\"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241159.webp\\",\\"https://bitbucket.org/xlc520/blogasset/raw/main/images2/640-164346343241160.webp\\"],\\"datePublished\\":\\"2022-01-15T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-27T13:32:36.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"xlc520\\"}]}"]]},"headers":[{"level":2,"title":"前言","slug":"前言","link":"#前言","children":[]},{"level":2,"title":"资源权限","slug":"资源权限","link":"#资源权限","children":[{"level":3,"title":"1.静态资源准备","slug":"_1-静态资源准备","link":"#_1-静态资源准备","children":[]},{"level":3,"title":"2.自定义一个异常，便于拦截抛出","slug":"_2-自定义一个异常-便于拦截抛出","link":"#_2-自定义一个异常-便于拦截抛出","children":[]},{"level":3,"title":"3.全局异常处理","slug":"_3-全局异常处理","link":"#_3-全局异常处理","children":[]},{"level":3,"title":"4.controller 层","slug":"_4-controller-层","link":"#_4-controller-层","children":[]},{"level":3,"title":"5.拦截器创建","slug":"_5-拦截器创建","link":"#_5-拦截器创建","children":[]},{"level":3,"title":"6.将拦截器注入应用","slug":"_6-将拦截器注入应用","link":"#_6-将拦截器注入应用","children":[]},{"level":3,"title":"7.验证查看结果","slug":"_7-验证查看结果","link":"#_7-验证查看结果","children":[]}]},{"level":2,"title":"操作权限","slug":"操作权限","link":"#操作权限","children":[{"level":3,"title":"1.和上面一样使用静态资源","slug":"_1-和上面一样使用静态资源","link":"#_1-和上面一样使用静态资源","children":[]},{"level":3,"title":"2.自定义注解","slug":"_2-自定义注解","link":"#_2-自定义注解","children":[]},{"level":3,"title":"3.controller 层","slug":"_3-controller-层","link":"#_3-controller-层","children":[]},{"level":3,"title":"4.修改一下之前的拦截器","slug":"_4-修改一下之前的拦截器","link":"#_4-修改一下之前的拦截器","children":[]},{"level":3,"title":"5.验证结果","slug":"_5-验证结果","link":"#_5-验证结果","children":[]}]},{"level":2,"title":"角色权限","slug":"角色权限","link":"#角色权限","children":[{"level":3,"title":"1.静态对应关系","slug":"_1-静态对应关系","link":"#_1-静态对应关系","children":[]},{"level":3,"title":"2.修改 controller","slug":"_2-修改-controller","link":"#_2-修改-controller","children":[]},{"level":3,"title":"3.修改一下拦截器","slug":"_3-修改一下拦截器","link":"#_3-修改一下拦截器","children":[]},{"level":3,"title":"4.结果测试","slug":"_4-结果测试","link":"#_4-结果测试","children":[]}]},{"level":2,"title":"总结","slug":"总结","link":"#总结","children":[]}],"git":{"createdTime":1647698494000,"updatedTime":1714224756000,"contributors":[{"name":"xlc","email":"2215400217@qq.com","commits":2},{"name":"xlc520","email":"2215400217@qq.com","commits":2}]},"readingTime":{"minutes":8.37,"words":2512},"filePathRelative":"dev/SpringBoot.md","localizedDate":"2022年1月15日"}');export{Jn as comp,Fn as data};
