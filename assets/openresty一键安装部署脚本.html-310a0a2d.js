import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as e,c as s,a as t}from"./app-4a6db5be.js";const a={},o=t(`<h1 id="openresty一键安装部署脚本" tabindex="-1"><a class="header-anchor" href="#openresty一键安装部署脚本" aria-hidden="true">#</a> openresty一键安装部署脚本</h1><p><strong>openresty的一些核心简介：</strong></p><p>openresty是一个成熟的网络平台，它集成了标准的Nginx核心，LuaJIT，许多精心编写的Lua库，许多高质量的第三方Nginx模块以及大多数外部依赖项。</p><ul><li>网站：http：//openresty.org/</li><li>Github组织：https：//github.com/openresty</li><li>首席开发人员：@agentzh</li><li>国内最可利用的文档：</li><li>http://wiki.jikexueyuan.com/project/openresty/</li></ul><p><strong>一键安装部署脚本如下：</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># 第一个参数为 OpenResty 的版本号VERSION=$1OPENRESTY_FILE=&quot;openresty-\${VERSION}.tar.gz&quot;OPENRESTY_URL=&quot;https://openresty.org/download/\${OPENRESTY_FILE}&quot;OPENRESTY_MD5_URL=&quot;\${OPENRESTY_URL}.md5&quot;INSTALL_DIR=&quot;/data/openresty&quot;</span>
<span class="token comment"># 检查 OpenResty 文件是否存在if [ ! -f &quot;$OPENRESTY_FILE&quot; ]; then  echo &quot;正在下载 \${OPENRESTY_URL}...&quot;  wget &quot;$OPENRESTY_URL&quot;</span>
  <span class="token comment"># 检查下载是否成功  if [ &quot;$?&quot; -ne 0 ]; then    echo &quot;下载 \${OPENRESTY_URL} 失败&quot;    exit 1  fifi</span>
<span class="token comment"># 检查 OpenResty 文件的 MD5echo &quot;正在获取 \${OPENRESTY_FILE} 的 MD5 值...&quot;wget &quot;$OPENRESTY_MD5_URL&quot;</span>
<span class="token comment"># 检查获取 MD5 文件是否成功if [ &quot;$?&quot; -ne 0 ]; then  echo &quot;获取 \${OPENRESTY_MD5_URL} 失败&quot;  exit 1fi</span>
<span class="token comment"># 提取 MD5 值并检查是否匹配EXPECTED_MD5=$(cat &quot;\${OPENRESTY_FILE}.md5&quot; | awk &#39;{ print $1 }&#39;)ACTUAL_MD5=$(md5sum &quot;$OPENRESTY_FILE&quot; | awk &#39;{ print $1 }&#39;)if [ &quot;$EXPECTED_MD5&quot; != &quot;$ACTUAL_MD5&quot; ]; then  echo &quot;下载的 \${OPENRESTY_FILE} 文件的 MD5 值不匹配&quot;  exit 1fi</span>
<span class="token comment"># 安装依赖yum install -y gcc make pcre-devel openssl-devel</span>
<span class="token comment"># 解压并编译安装 OpenRestytar -xzvf &quot;$OPENRESTY_FILE&quot;cd &quot;openresty-$VERSION&quot;./configure --prefix=&quot;$INSTALL_DIR&quot;makemake install</span>
<span class="token comment"># 检查安装是否成功if [ &quot;$?&quot; -ne 0 ]; then  echo &quot;OpenResty $VERSION 安装失败&quot;  exit 1fi</span>
<span class="token comment"># 添加 OpenResty 到环境变量echo &#39;export PATH=$PATH:&#39;&quot;$INSTALL_DIR/bin&quot;&#39;/&#39; &gt;&gt; /etc/profilesource /etc/profile</span>
<span class="token comment"># 创建 OpenResty 服务文件echo &quot;正在创建 OpenResty 服务文件...&quot;cat &lt;&lt;EOF &gt; /etc/systemd/system/openresty.service[Unit]Description=OpenResty HTTP ServerAfter=network.target</span>
<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>Type<span class="token operator">=</span>forkingPIDFile<span class="token operator">=</span>/run/openresty.pidExecStart<span class="token operator">=</span><span class="token variable">$INSTALL_DIR</span>/nginx/sbin/nginx <span class="token parameter variable">-c</span> <span class="token variable">$INSTALL_DIR</span>/nginx/conf/nginx.confExecReload<span class="token operator">=</span>/bin/kill <span class="token parameter variable">-s</span> HUP <span class="token punctuation">\\</span><span class="token variable">$MAINPIDExecStop</span><span class="token operator">=</span>/bin/kill <span class="token parameter variable">-s</span> QUIT <span class="token punctuation">\\</span><span class="token variable">$MAINPIDPrivateTmp</span><span class="token operator">=</span>true
<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>WantedBy<span class="token operator">=</span>multi-user.targetEOF
<span class="token comment"># 启动 OpenResty 服务systemctl daemon-reloadsystemctl enable openrestysystemctl start openresty</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;OpenResty <span class="token variable">$VERSION</span> 已安装到 <span class="token variable">$INSTALL_DIR</span>，并已启动 OpenResty 服务&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以使用执行脚本后带版本号执行安装相应版本的openresty</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sh</span> install_openresty.sh <span class="token number">1.19</span>.3.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,8),p=[o];function i(l,c){return e(),s("div",null,p)}const d=n(a,[["render",i],["__file","openresty一键安装部署脚本.html.vue"]]);export{d as default};
