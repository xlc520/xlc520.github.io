const e=JSON.parse('{"key":"v-56dc1580","path":"/dev/EasyExcel%E5%B8%A6%E6%A0%BC%E5%BC%8F%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AF%BC%E5%87%BA%E7%99%BE%E4%B8%87%E6%95%B0%E6%8D%AE.html","title":"EasyExcel带格式多线程导出百万数据","lang":"zh-CN","frontmatter":{"author":"xlc520","title":"EasyExcel带格式多线程导出百万数据","description":"EasyExcel带格式多线程导出百万数据 1. 背景说明 针对明细报表，用户会选择针对当前明细数据进行导出，便于本地或者线下进行处理或者计算等需求。不过一般在这种大数据量的导出任务下，会引发以下问题：     1） 响应时间较慢；     2） 内存资源占用过大，基本上一个大数据量的导出会消耗可视化服务的所有资源，引起内存回收，其它接口无响应；     考虑到单个excel文件过大，采用压缩文件流zip的方式，一个excel只有一个页签，一个页签最多十万条数据，所以少于十万条数据，会导出excel文件，而非zip压缩文件。另外，这里导出功能的速率不能单以数据条数为量级进行衡量，平常一般一万条数据就是1M字节。较为准确的公式如下（借此就可以评估出很多数据导出的文件大小）：","date":"2023-03-16T00:00:00.000Z","category":"Java","tag":"Java","article":true,"timeline":true,"icon":"java","head":[["meta",{"property":"og:url","content":"https://blog.ciberviler.top/dev/EasyExcel%E5%B8%A6%E6%A0%BC%E5%BC%8F%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AF%BC%E5%87%BA%E7%99%BE%E4%B8%87%E6%95%B0%E6%8D%AE.html"}],["meta",{"property":"og:site_name","content":"StudyNote"}],["meta",{"property":"og:title","content":"EasyExcel带格式多线程导出百万数据"}],["meta",{"property":"og:description","content":"EasyExcel带格式多线程导出百万数据 1. 背景说明 针对明细报表，用户会选择针对当前明细数据进行导出，便于本地或者线下进行处理或者计算等需求。不过一般在这种大数据量的导出任务下，会引发以下问题：     1） 响应时间较慢；     2） 内存资源占用过大，基本上一个大数据量的导出会消耗可视化服务的所有资源，引起内存回收，其它接口无响应；     考虑到单个excel文件过大，采用压缩文件流zip的方式，一个excel只有一个页签，一个页签最多十万条数据，所以少于十万条数据，会导出excel文件，而非zip压缩文件。另外，这里导出功能的速率不能单以数据条数为量级进行衡量，平常一般一万条数据就是1M字节。较为准确的公式如下（借此就可以评估出很多数据导出的文件大小）："}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-08-02T06:25:31.000Z"}],["meta",{"property":"article:author","content":"xlc520"}],["meta",{"property":"article:tag","content":"Java"}],["meta",{"property":"article:published_time","content":"2023-03-16T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-08-02T06:25:31.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"EasyExcel带格式多线程导出百万数据\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-03-16T00:00:00.000Z\\",\\"dateModified\\":\\"2023-08-02T06:25:31.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"xlc520\\"}]}"]]},"headers":[{"level":2,"title":"1. 背景说明","slug":"_1-背景说明","link":"#_1-背景说明","children":[]},{"level":2,"title":"2. 方案概述","slug":"_2-方案概述","link":"#_2-方案概述","children":[{"level":3,"title":"（1）大数据量导出问题主要是以下三个地方：","slug":"_1-大数据量导出问题主要是以下三个地方","link":"#_1-大数据量导出问题主要是以下三个地方","children":[]},{"level":3,"title":"（2）将写入导出Excel等功能单独分开成一个微服务：","slug":"_2-将写入导出excel等功能单独分开成一个微服务","link":"#_2-将写入导出excel等功能单独分开成一个微服务","children":[]},{"level":3,"title":"（3）注意：","slug":"_3-注意","link":"#_3-注意","children":[]},{"level":3,"title":"（4）方案设计：","slug":"_4-方案设计","link":"#_4-方案设计","children":[]},{"level":3,"title":"（5）maven依赖：","slug":"_5-maven依赖","link":"#_5-maven依赖","children":[]}]},{"level":2,"title":"3. 详细设计","slug":"_3-详细设计","link":"#_3-详细设计","children":[]},{"level":2,"title":"4. 缓存","slug":"_4-缓存","link":"#_4-缓存","children":[]},{"level":2,"title":"5. 可行性验证","slug":"_5-可行性验证","link":"#_5-可行性验证","children":[]},{"level":2,"title":"6. 代码","slug":"_6-代码","link":"#_6-代码","children":[]}],"git":{"createdTime":1678870593000,"updatedTime":1690957531000,"contributors":[{"name":"xlc520","email":"2215400217@qq.com","commits":4}]},"readingTime":{"minutes":12.65,"words":3795},"filePathRelative":"dev/EasyExcel带格式多线程导出百万数据.md","localizedDate":"2023年3月16日","excerpt":"<h1> EasyExcel带格式多线程导出百万数据</h1>\\n<h2> 1. 背景说明</h2>\\n<p>针对明细报表，用户会选择针对当前明细数据进行导出，便于本地或者线下进行处理或者计算等需求。不过一般在这种大数据量的导出任务下，会引发以下问题：<br>\\n    1） 响应时间较慢；<br>\\n    2） 内存资源占用过大，基本上一个大数据量的导出会消耗可视化服务的所有资源，引起内存回收，其它接口无响应；<br>\\n    考虑到单个excel文件过大，采用压缩文件流zip的方式，一个excel只有一个页签，一个页签最多十万条数据，所以少于十万条数据，会导出excel文件，而非zip压缩文件。另外，这里导出功能的速率不能单以数据条数为量级进行衡量，平常一般一万条数据就是1M字节。较为准确的公式如下（借此就可以评估出很多数据导出的文件大小）：</p>","autoDesc":true}');export{e as data};
