import{_ as n}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as s,c as a,a as t}from"./app-V68d0221.js";const p={},e=t(`<h1 id="使用-easypoi-导出-excel-实现动态列" tabindex="-1"><a class="header-anchor" href="#使用-easypoi-导出-excel-实现动态列" aria-hidden="true">#</a> 使用 easypoi 导出 excel 实现动态列</h1><h3 id="说明" tabindex="-1"><a class="header-anchor" href="#说明" aria-hidden="true">#</a> 说明</h3><ul><li>使用的是easypoi进行导出</li><li>行头是动态生成</li><li>依据key进行列匹配，进行数据填充</li><li>第一列进行纵向动态合并</li></ul><h3 id="工具依赖" tabindex="-1"><a class="header-anchor" href="#工具依赖" aria-hidden="true">#</a> 工具依赖</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.afterturn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>easypoi-base<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.afterturn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>easypoi-annotation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.afterturn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>easypoi-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现效果" tabindex="-1"><a class="header-anchor" href="#实现效果" aria-hidden="true">#</a> 实现效果</h3><p>变更前样式</p><figure><img src="https://static.xlc520.tk/blogImage/640-1674184514758-0.png" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><p>变更后样式</p><figure><img src="https://static.xlc520.tk/blogImage/640-1674184514758-3.png" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><h3 id="代码解析" tabindex="-1"><a class="header-anchor" href="#代码解析" aria-hidden="true">#</a> 代码解析</h3><h5 id="动态生成列头" tabindex="-1"><a class="header-anchor" href="#动态生成列头" aria-hidden="true">#</a> 动态生成列头</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>  <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ExcelExportEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">dynamicNewAddExcel</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">PlatformStatisParamRespData</span><span class="token punctuation">&gt;</span></span> paramInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//表头的集合，用于添加表头</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ExcelExportEntity</span><span class="token punctuation">&gt;</span></span> entityList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment">//ExcelExportEntity构造参数【第一个是列名头的统计字段,第二个是需要指定的一个key在填充数据的时候是需要根据这个key进行填充值,第三个参数是列宽】</span>
    <span class="token class-name">ExcelExportEntity</span> platformXh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelExportEntity</span><span class="token punctuation">(</span><span class="token string">&quot;统计字段1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;statisKey1&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//列的合并(纵向列的同名称会进行合并,效果见上图的平台名称的变化)</span>
    platformXh<span class="token punctuation">.</span><span class="token function">setMergeVertical</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    entityList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>platformXh<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">ExcelExportEntity</span> statisDateXh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelExportEntity</span><span class="token punctuation">(</span><span class="token string">&quot;统计字段2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;statisKey2&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    entityList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>statisDateXh<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//参数信息--[用于动态拼接列头]</span>
    <span class="token keyword">final</span> <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> paramInfo<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">final</span> <span class="token class-name">String</span> paramKeyStr <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">final</span> <span class="token class-name">String</span> paramNameStr <span class="token operator">=</span> paramInfo<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>paramKeyStr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDataName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//列头由参数汉字名称,参数key为列key</span>
      entityList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ExcelExportEntity</span><span class="token punctuation">(</span>paramNameStr<span class="token punctuation">,</span> paramKeyStr<span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> entityList<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="动态填充数据" tabindex="-1"><a class="header-anchor" href="#动态填充数据" aria-hidden="true">#</a> 动态填充数据</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">dynamicListDataByKey</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PlatformIncomeRespDTO</span><span class="token punctuation">&gt;</span></span> statisData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//参数类型</span>
    <span class="token keyword">final</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> statisParamKey <span class="token operator">=</span> statisData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParamInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> statisDate <span class="token operator">=</span> statisData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStatisDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token keyword">int</span> platformNum <span class="token operator">=</span> statisData<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//最终的数据</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> datas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> platformNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> statisDate<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//这个是依据key进行数据的填充,(根据前面填写的statisKey1进行填充数据)</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;statisKey1&quot;</span><span class="token punctuation">,</span> statisData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPlatformNickName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> statisDateStr <span class="token operator">=</span> statisDate<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">//这个是依据key进行数据的填充,(根据前面填写的statisKey2进行填充数据)</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;statisKey2&quot;</span><span class="token punctuation">,</span> statisDateStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//参数的验证</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> paramKey <span class="token operator">:</span> statisParamKey<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">BiPlatformStatisRespDTO</span> paramData <span class="token operator">:</span> statisData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStatisData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>paramKey<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>paramData<span class="token punctuation">.</span><span class="token function">getParamKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>paramData<span class="token punctuation">.</span><span class="token function">getParamKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> paramData<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">+</span> paramData<span class="token punctuation">.</span><span class="token function">getRateValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        datas<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>hashMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> datas<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="excel的导出" tabindex="-1"><a class="header-anchor" href="#excel的导出" aria-hidden="true">#</a> excel的导出</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//statisData就是我们查询出来的数据</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadPlatformIncomeContrast</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PlatformIncomeRespDTO</span><span class="token punctuation">&gt;</span></span> statisData<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>statisData<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//获取参数信息</span>
    <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">PlatformStatisParamRespData</span><span class="token punctuation">&gt;</span></span> paramInfo <span class="token operator">=</span> statisData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParamInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//拼装列头</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ExcelExportEntity</span><span class="token punctuation">&gt;</span></span> colList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dynamicNewAddExcel</span><span class="token punctuation">(</span>paramInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//数据拼装</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dynamicListDataByKey</span><span class="token punctuation">(</span>statisData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">String</span> xlsFileName <span class="token operator">=</span> <span class="token class-name">DateHelper</span><span class="token punctuation">.</span><span class="token function">getNowString</span><span class="token punctuation">(</span><span class="token class-name">FormatUnit</span><span class="token punctuation">.</span>yyyyMMddHHmmss<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;.xls&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> <span class="token class-name">ExcelExportUtil</span><span class="token punctuation">.</span><span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ExportParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> colList<span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//动态合并纵列[mergeMap key列索引(从0开始),value依赖的列,没有传空,startRow 开始行(从零开始)]</span>
    <span class="token comment">//Map&lt;Integer, int[]&gt; mer = new HashMap&lt;&gt;();</span>
    <span class="token comment">//mer.put(0, new int[]{});</span>
    <span class="token comment">//PoiMergeCellUtil.mergeCells(workbook.getSheetAt(0), mer, 1);</span>
    <span class="token class-name">EasypoiUtil</span><span class="token punctuation">.</span><span class="token function">downLoadExcel</span><span class="token punctuation">(</span>xlsFileName<span class="token punctuation">,</span> response<span class="token punctuation">,</span> workbook<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>EasypoiUtil工具类</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">downLoadExcel</span><span class="token punctuation">(</span><span class="token class-name">String</span> fileName<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Workbook</span> workbook<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      response<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/vnd.ms-excel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Disposition&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;attachment;filename=&quot;</span> <span class="token operator">+</span> <span class="token class-name">URLEncoder</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      workbook<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>PlatformIncomeRespDTO</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlatformIncomeRespDTO</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>

  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1100499105160261425L</span><span class="token punctuation">;</span>


  <span class="token doc-comment comment">/**
   * 平台别名
   */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> platformNickName<span class="token punctuation">;</span>

  <span class="token comment">/*统计时间*/</span>
  <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> statisDate<span class="token punctuation">;</span>

  <span class="token comment">/*查询参数信息--[用户收入来源统计导出使用]*/</span>
  <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">PlatformStatisParamRespData</span><span class="token punctuation">&gt;</span></span> paramInfo<span class="token punctuation">;</span>


  <span class="token comment">/*统计数据*/</span>
  <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">BiPlatformStatisRespDTO</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> statisData<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>PlatformStatisParamRespData</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlatformStatisParamRespData</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>

  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">4263523446154995471L</span><span class="token punctuation">;</span>

  <span class="token doc-comment comment">/**
   * 参数名称
   */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> dataName<span class="token punctuation">;</span>

  <span class="token doc-comment comment">/**
   * 参数key
   */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> dateKey<span class="token punctuation">;</span>

  <span class="token doc-comment comment">/**
   * 参数描述
   */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> dateDesc<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>BiPlatformStatisRespDTO</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BiPlatformStatisRespDTO</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>

  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">6070471415344415351L</span><span class="token punctuation">;</span>

  <span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;统计字段&quot;</span><span class="token punctuation">,</span> orderNum <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> param<span class="token punctuation">;</span>

  <span class="token doc-comment comment">/**
   * 参数的key
   */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> paramKey<span class="token punctuation">;</span>

  <span class="token doc-comment comment">/**
   * 参数描述
   */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> paramDesc<span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token class-name">String</span> startDate<span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token class-name">String</span> endDate<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;统计数据&quot;</span><span class="token punctuation">,</span> orderNum <span class="token operator">=</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> value<span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token class-name">String</span> rateValue<span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token class-name">Integer</span> riseOrFall<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">BiPlatformStatisRespDTO</span><span class="token punctuation">(</span><span class="token class-name">String</span> startDate<span class="token punctuation">,</span> <span class="token class-name">String</span> paramKey<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>paramKey <span class="token operator">=</span> paramKey<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>startDate <span class="token operator">=</span> startDate<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">BiPlatformStatisRespDTO</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="测试用例" tabindex="-1"><a class="header-anchor" href="#测试用例" aria-hidden="true">#</a> 测试用例</h3><h5 id="测试特殊说明" tabindex="-1"><a class="header-anchor" href="#测试特殊说明" aria-hidden="true">#</a> 测试特殊说明</h5><p>导出的结果有个控制,是在拼装的时候没有填充此数据,不影响整体效果。</p><h5 id="测试结果示例" tabindex="-1"><a class="header-anchor" href="#测试结果示例" aria-hidden="true">#</a> 测试结果示例</h5><figure><img src="https://static.xlc520.tk/blogImage/640-1674184521222-6.png" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><h5 id="测试数据json示例" tabindex="-1"><a class="header-anchor" href="#测试数据json示例" aria-hidden="true">#</a> 测试数据json示例</h5><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;paramInfo&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;userCount&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;dataName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;用户数&quot;</span><span class="token punctuation">,</span> 
                <span class="token property">&quot;dateDesc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;用户信息&quot;</span><span class="token punctuation">,</span> 
                <span class="token property">&quot;dateKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;userCount&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;friendsCount&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;dataName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;好友数&quot;</span><span class="token punctuation">,</span> 
                <span class="token property">&quot;dateDesc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;好友信息&quot;</span><span class="token punctuation">,</span> 
                <span class="token property">&quot;dateKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;friendsCount&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token property">&quot;platformNickName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;aaa&quot;</span><span class="token punctuation">,</span> 
        <span class="token property">&quot;statisData&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;paramKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;userCount&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;startDate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2019-12-26&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;100&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;paramKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;friendsCount&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;startDate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2019-12-26&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;200&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span> 
            <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;paramKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;userCount&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;startDate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2019-12-27&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;300&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;paramKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;friendsCount&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;startDate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2019-12-27&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;400&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span> 
        <span class="token property">&quot;statisDate&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;2019-12-26&quot;</span><span class="token punctuation">,</span> 
            <span class="token string">&quot;2019-12-27&quot;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span>
        <span class="token property">&quot;paramInfo&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;userCount&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;dataName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;用户数&quot;</span><span class="token punctuation">,</span> 
                <span class="token property">&quot;dateDesc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;用户信息&quot;</span><span class="token punctuation">,</span> 
                <span class="token property">&quot;dateKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;userCount&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;friendsCount&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;dataName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;好友数&quot;</span><span class="token punctuation">,</span> 
                <span class="token property">&quot;dateDesc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;好友信息&quot;</span><span class="token punctuation">,</span> 
                <span class="token property">&quot;dateKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;friendsCount&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token property">&quot;platformNickName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bbb&quot;</span><span class="token punctuation">,</span> 
        <span class="token property">&quot;statisData&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;paramKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;userCount&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;startDate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2019-12-26&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;500&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;paramKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;friendsCount&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;startDate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2019-12-26&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;600&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span> 
            <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;paramKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;userCount&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;startDate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2019-12-27&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;700&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span> 
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;paramKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;friendsCount&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;startDate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2019-12-27&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;800&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span> 
        <span class="token property">&quot;statisDate&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;2019-12-26&quot;</span><span class="token punctuation">,</span> 
            <span class="token string">&quot;2019-12-27&quot;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="测试用例代码" tabindex="-1"><a class="header-anchor" href="#测试用例代码" aria-hidden="true">#</a> 测试用例代码</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Simple</span> <span class="token punctuation">{</span>

  <span class="token doc-comment comment">/**
   * @Description: 拼接表头
   * @Param: paramInfo :表头信息
   * <span class="token keyword">@return</span>: java.util.List<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cn.afterturn.easypoi.excel.entity.params.ExcelExportEntity</span><span class="token punctuation">&gt;</span></span>
   * @Author: peikunkun
   * @Date: 2019/12/26 0026 上午 10:42
   */</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ExcelExportEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">dynamicNewAddExcel</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">PlatformStatisParamRespData</span><span class="token punctuation">&gt;</span></span> paramInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//表头的集合，用于添加表头</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ExcelExportEntity</span><span class="token punctuation">&gt;</span></span> entityList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//ExcelExportEntity构造参数【第一个是列名头的统计字段,第二个是需要指定的一个key在填充数据的时候是需要根据这个key进行填充值,第三个参数是列宽】</span>
    <span class="token class-name">ExcelExportEntity</span> platformXh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelExportEntity</span><span class="token punctuation">(</span><span class="token string">&quot;统计字段1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;statisKey1&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//列的合并(纵向列的同名称会进行合并,效果见上图的平台名称的变化)</span>
    platformXh<span class="token punctuation">.</span><span class="token function">setMergeVertical</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    entityList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>platformXh<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">ExcelExportEntity</span> statisDateXh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelExportEntity</span><span class="token punctuation">(</span><span class="token string">&quot;统计字段2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;statisKey2&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    entityList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>statisDateXh<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//参数信息--[用于动态拼接列头]</span>
    <span class="token keyword">final</span> <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> paramInfo<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">final</span> <span class="token class-name">String</span> paramKeyStr <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">final</span> <span class="token class-name">String</span> paramNameStr <span class="token operator">=</span> paramInfo<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>paramKeyStr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDataName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//列头由参数汉字名称,参数key为列key</span>
      entityList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ExcelExportEntity</span><span class="token punctuation">(</span>paramNameStr<span class="token punctuation">,</span> paramKeyStr<span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> entityList<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>


  <span class="token doc-comment comment">/**
   * @Description: 拼接数据
   * @Param: statisData :拼接数据
   * @Author: peikunkun
   * @Date: 2019/12/26 0026 上午 10:42
   */</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">dynamicListDataByKey</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PlatformIncomeRespDTO</span><span class="token punctuation">&gt;</span></span> statisData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//参数类型</span>
    <span class="token keyword">final</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> statisParamKey <span class="token operator">=</span> statisData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParamInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> statisDate <span class="token operator">=</span> statisData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStatisDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token keyword">int</span> platformNum <span class="token operator">=</span> statisData<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//最终的数据</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> datas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> platformNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> statisDate<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//这个是依据key进行数据的填充,(根据前面填写的statisKey1进行填充数据)</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;statisKey1&quot;</span><span class="token punctuation">,</span> statisData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPlatformNickName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> statisDateStr <span class="token operator">=</span> statisDate<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//这个是依据key进行数据的填充,(根据前面填写的statisKey2进行填充  数据)</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;statisKey2&quot;</span><span class="token punctuation">,</span> statisDateStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//参数的验证</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> paramKey <span class="token operator">:</span> statisParamKey<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">BiPlatformStatisRespDTO</span> paramData <span class="token operator">:</span> statisData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStatisData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>paramKey<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>paramData<span class="token punctuation">.</span><span class="token function">getParamKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>paramData<span class="token punctuation">.</span><span class="token function">getParamKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> paramData<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">+</span> paramData<span class="token punctuation">.</span><span class="token function">getRateValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        datas<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>hashMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> datas<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>


  <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">Administrator_84_20191226095523</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;欢迎使用单元测试方法【Administrator_84()_20191226095523】&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;此方法测试描述：【】&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//拼装第一个数据---------------------------------------------------------------------</span>
    <span class="token keyword">final</span> <span class="token class-name">PlatformIncomeRespDTO</span> platformIncomeRespDTO1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PlatformIncomeRespDTO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    platformIncomeRespDTO1<span class="token punctuation">.</span><span class="token function">setPlatformNickName</span><span class="token punctuation">(</span><span class="token string">&quot;aaa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//拼装时间维度</span>
    platformIncomeRespDTO1<span class="token punctuation">.</span><span class="token function">setStatisDate</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token string">&quot;2019-12-26&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;2019-12-27&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//拼装头信息</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">PlatformStatisParamRespData</span><span class="token punctuation">&gt;</span></span> paramInfo1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    paramInfo1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;userCount&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PlatformStatisParamRespData</span><span class="token punctuation">(</span><span class="token string">&quot;用户数&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;userCount&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;用户信息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    paramInfo1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;friendsCount&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PlatformStatisParamRespData</span><span class="token punctuation">(</span><span class="token string">&quot;好友数&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;friendsCount&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;好友信息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    platformIncomeRespDTO1<span class="token punctuation">.</span><span class="token function">setParamInfo</span><span class="token punctuation">(</span>paramInfo1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//拼装数据</span>
    <span class="token keyword">final</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">BiPlatformStatisRespDTO</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> data1 <span class="token operator">=</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BiPlatformStatisRespDTO</span><span class="token punctuation">(</span><span class="token string">&quot;2019-12-26&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;userCount&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;100&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">BiPlatformStatisRespDTO</span><span class="token punctuation">(</span><span class="token string">&quot;2019-12-26&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;friendsCount&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;200&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BiPlatformStatisRespDTO</span><span class="token punctuation">(</span><span class="token string">&quot;2019-12-27&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;userCount&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;300&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">BiPlatformStatisRespDTO</span><span class="token punctuation">(</span><span class="token string">&quot;2019-12-27&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;friendsCount&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;400&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    platformIncomeRespDTO1<span class="token punctuation">.</span><span class="token function">setStatisData</span><span class="token punctuation">(</span>data1<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token comment">//拼装第二个数据---------------------------------------------------------------------</span>
    <span class="token keyword">final</span> <span class="token class-name">PlatformIncomeRespDTO</span> platformIncomeRespDTO2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PlatformIncomeRespDTO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    platformIncomeRespDTO2<span class="token punctuation">.</span><span class="token function">setPlatformNickName</span><span class="token punctuation">(</span><span class="token string">&quot;bbb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//拼装时间维度</span>
    platformIncomeRespDTO2<span class="token punctuation">.</span><span class="token function">setStatisDate</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token string">&quot;2019-12-26&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;2019-12-27&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//拼装头信息</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">PlatformStatisParamRespData</span><span class="token punctuation">&gt;</span></span> paramInfo2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    paramInfo2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;userCount&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PlatformStatisParamRespData</span><span class="token punctuation">(</span><span class="token string">&quot;用户数&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;userCount&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;用户信息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    paramInfo2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;friendsCount&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PlatformStatisParamRespData</span><span class="token punctuation">(</span><span class="token string">&quot;好友数&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;friendsCount&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;好友信息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    platformIncomeRespDTO2<span class="token punctuation">.</span><span class="token function">setParamInfo</span><span class="token punctuation">(</span>paramInfo2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//拼装数据</span>
    <span class="token keyword">final</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">BiPlatformStatisRespDTO</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> data2 <span class="token operator">=</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data2<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BiPlatformStatisRespDTO</span><span class="token punctuation">(</span><span class="token string">&quot;2019-12-26&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;userCount&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;500&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">BiPlatformStatisRespDTO</span><span class="token punctuation">(</span><span class="token string">&quot;2019-12-26&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;friendsCount&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;600&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data2<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BiPlatformStatisRespDTO</span><span class="token punctuation">(</span><span class="token string">&quot;2019-12-27&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;userCount&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;700&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">BiPlatformStatisRespDTO</span><span class="token punctuation">(</span><span class="token string">&quot;2019-12-27&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;friendsCount&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;800&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    platformIncomeRespDTO2<span class="token punctuation">.</span><span class="token function">setStatisData</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">final</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PlatformIncomeRespDTO</span><span class="token punctuation">&gt;</span></span> platformIncomeRespDTOS <span class="token operator">=</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span>platformIncomeRespDTO1<span class="token punctuation">,</span> platformIncomeRespDTO2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>platformIncomeRespDTOS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//拼装列头</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ExcelExportEntity</span><span class="token punctuation">&gt;</span></span> colList <span class="token operator">=</span> <span class="token function">dynamicNewAddExcel</span><span class="token punctuation">(</span>paramInfo2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//数据拼装</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token function">dynamicListDataByKey</span><span class="token punctuation">(</span>platformIncomeRespDTOS<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//文件名称</span>
    <span class="token keyword">final</span> <span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> <span class="token class-name">ExcelExportUtil</span><span class="token punctuation">.</span><span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ExportParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> colList<span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//此功能与【拼装列头】中的 platformXh.setMergeVertical(true);功能效果一样,可直接使用 platformXh.setMergeVertical(true);进行纵向合并</span>
    <span class="token comment">//动态合并纵列[mergeMap key列索引(从0开始),value依赖的列,没有传空,startRow 开始行(从零开始)]</span>
    <span class="token comment">//Map&lt;Integer, int[]&gt; mer = new HashMap&lt;&gt;();</span>
    <span class="token comment">//mer.put(0, new int[]{});</span>
    <span class="token comment">//PoiMergeCellUtil.mergeCells(workbook.getSheetAt(0), mer, 1);</span>

    <span class="token keyword">final</span> <span class="token class-name">FileOutputStream</span> fileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">&quot;C:\\\\Users\\\\Administrator\\\\Desktop\\\\1.xls&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//导出excel</span>
    <span class="token function">downLoadExcel</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> fileOutputStream<span class="token punctuation">,</span> workbook<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>




  <span class="token doc-comment comment">/**
   * @Description: 下载文件
   * @Param: fileName
   * @Param outputStream
   * @Param workbook
   * <span class="token keyword">@return</span>: void
   * @Author: peikunkun
   * @Date: 2019/12/26 0026 上午 10:44
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">downLoadExcel</span><span class="token punctuation">(</span><span class="token class-name">String</span> fileName<span class="token punctuation">,</span> <span class="token class-name">FileOutputStream</span> outputStream<span class="token punctuation">,</span> <span class="token class-name">Workbook</span> workbook<span class="token punctuation">)</span>
      <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      workbook<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>outputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      outputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,34),o=[e];function c(l,i){return s(),a("div",null,o)}const r=n(p,[["render",c],["__file","使用easypoi导出excel实现动态列.html.vue"]]);export{r as default};
